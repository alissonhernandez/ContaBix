<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Usuarios - Contabix</title>
    <link rel="stylesheet" th:href="@{/css/gestionusuario.css}">
</head>
<body>

<!-- Navbar -->
<nav class="navbar">
    <div class="logo">Contabix</div>
    <div class="hamburger" id="hamburger">&#9776;</div>
    <ul class="nav-links" id="nav-links">
        <li><a th:href="@{/inicio}">Inicio</a></li>
        <li><a th:href="@{/perfil}">Perfil</a></li>
        <li><a th:href="@{/librodiario}">Libro Diario</a></li>
        <li><a th:href="@{/libromayor}">Libro Mayor</a></li>
        <li th:if="${usuario.rol.nombre == 'admin'}"><a th:href="@{/admin/usuarios}">Gestión de Usuarios</a></li>
        <li><a th:href="@{/logout}">Cerrar Sesión</a></li>
    </ul>
</nav>

<!-- Encabezado -->
<header class="page-header">
    <h2>Usuarios registrados</h2>
    <p>Administra los roles y accesos de los usuarios registrados en el sistema.</p>
</header>

<!-- Tabla de usuarios -->
<div class="table-container">
    <table>
        <thead>
        <tr>
            <th>Nombre</th>
            <th>Correo</th>
            <th>Rol</th>
            <th>Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="u : ${usuarios}">
            <td th:text="${u.nombre}"></td>
            <td th:text="${u.correo}"></td>
            <td th:text="${u.rol.nombre}"></td>
            <td class="acciones">
                <!-- Formulario para cambiar rol -->
                <form th:action="@{'/admin/usuarios/' + ${u.id} + '/rol'}" method="post">
                    <input type="number" name="rolId" placeholder="ID Rol" required>
                    <button type="submit" class="btn cambiar">Cambiar Rol</button>
                </form>

                <!-- Formulario para eliminar usuario -->
                <form th:action="@{'/admin/usuarios/' + ${u.id} + '/eliminar'}" method="post">
                    <button type="submit" class="btn eliminar" onclick="return confirm('¿Estás seguro de eliminar este usuario?')">Eliminar</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- Botón volver -->
<div class="volver">
    <a th:href="@{/inicio}" class="btn volver-btn">Volver al inicio</a>
</div>

<!-- Footer -->
<footer>
    <p>&copy; 2025 Contabix. Todos los derechos reservados.</p>
</footer>

<!-- Script menú hamburguesa -->
<script>
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('nav-links');
    hamburger.addEventListener('click', () => {
        navLinks.classList.toggle('active');
    });
</script>

</body>
</html>
